//=======================================================================================
//=======================================================================================
// PROGRAMA 		: Prueba FIFO-WAV
// FUNCIÓN 			: Práctica Proyecto de Grado
// REALIZADO POR	: Holguer A. Becerra D. - Jefferson M. García P. - Juan D. Prieto A.
// ORGANIZACIÓN		: Universidad pontificia Bolivariana
// FECHA 			: Mayo 2016
//=======================================================================================
//=======================================================================================

//=======================================================================================
// LIBRERIAS
//=======================================================================================
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <sys/mman.h>
#include "hwlib.h"
#include "socal.h"
#include "hps.h"
#include "alt_gpio.h"

#include "hps_0.h"
#include "include.h"

//=======================================================================================
// PARÁMETROS
//=======================================================================================
#define REG_BASE 0xC0000000
#define REG_SPAN 0x00100000

#define REG_BASE_LW 0xFF200000
#define REG_SPAN_LW 0x00200000

void* virtual_base;
void* virtual_base_lw;
void* led_addr;
void* sw_addr;
void* key_addr;
void* audio_addr;

int fd;
int sw;
int key;
int audio;
//=======================================================================================
// RUTINA: INICIO DEL SISTEMA
//=======================================================================================
void init_system()
{
	if((fd=open("/dev/mem",(O_RDWR|O_SYNC)))==-1)
	{
		printf( "ERROR: could not open \"/dev/mem\"...\n" );
		exit (1);
	}

	virtual_base = mmap(NULL,REG_SPAN,(PROT_READ|PROT_WRITE),MAP_SHARED,fd,REG_BASE);
	if(virtual_base==MAP_FAILED)
	{
		printf( "ERROR: mmap h2f() failed...\n" );
		close(fd);
		exit (2);
	}

	virtual_base_lw = mmap(NULL,REG_SPAN_LW,(PROT_READ|PROT_WRITE),MAP_SHARED,fd,REG_BASE_LW);

	if(virtual_base_lw==MAP_FAILED)
	{
		printf( "ERROR: mmap lw_h2f() failed...\n" );
		close(fd);
		exit (3);
	}

	sw_addr 		= virtual_base + (( unsigned long )( REG_BASE_LW + SW_BASE ) & (unsigned long)( REG_SPAN_LW-1 ));
	key_addr		= virtual_base + (( unsigned long )( REG_BASE + KEY_BASE ) & (unsigned long)( REG_SPAN-1 ));
	audio_addr		= virtual_base + (( unsigned long )( REG_BASE + AUDIO_R_BASE ) & (unsigned long)( REG_SPAN-1 ));
}




int main(int argc, char *argv[])
{
	//<><><><><><><><><><><><><><><><><>//
	// 		SYSTEM INITIALIZING			//
	//<><><><><><><><><><><><><><><><><>//
	init_system();

	while(1)
	{





	}
}
